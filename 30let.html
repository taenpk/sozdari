<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ö–≤–µ—Å—Ç –¥–ª—è –ù–∏–∫–∏—Ç—ã: Level 30</title>
    
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º React –∏ ReactDOM -->
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Babel –¥–ª—è —Ä–∞–±–æ—Ç—ã JSX –ø—Ä—è–º–æ –≤ –±—Ä–∞—É–∑–µ—Ä–µ -->
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <!-- –ü–æ–¥–∫–ª—é—á–∞–µ–º Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body { margin: 0; background-color: #1c1917; /* Stone-900 background */ }
        @keyframes shake {
            0%, 100% { transform: translateX(0); }
            25% { transform: translateX(-5px); }
            75% { transform: translateX(5px); }
        }
        .animate-shake {
            animation: shake 0.4s ease-in-out;
        }
        .animate-fade-in {
            animation: fadeIn 1s ease-out;
        }
        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
    </style>
</head>
<body>
    <div id="root"></div>

    <script type="text/babel">
        const { useState, useEffect, useRef } = React;

        // --- –ò–∫–æ–Ω–∫–∏ ---
        const IconBase = ({ children, className, size = 24 }) => (
            <svg 
                xmlns="http://www.w3.org/2000/svg" 
                width={size} 
                height={size} 
                viewBox="0 0 24 24" 
                fill="none" 
                stroke="currentColor" 
                strokeWidth="2" 
                strokeLinecap="round" 
                strokeLinejoin="round" 
                className={className}
            >
                {children}
            </svg>
        );

        const ArrowRight = (props) => <IconBase {...props}><path d="M5 12h14"/><path d="m12 5 7 7-7 7"/></IconBase>;
        const Heart = (props) => <IconBase {...props}><path d="M19 14c1.49-1.46 3-3.21 3-5.5A5.5 5.5 0 0 0 16.5 3c-1.76 0-3 .5-4.5 2-1.5-1.5-2.74-2-4.5-2A5.5 5.5 0 0 0 2 8.5c0 2.3 1.5 4.05 3 5.5l7 7Z"/></IconBase>;
        const Zap = (props) => <IconBase {...props}><polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2"/></IconBase>;
        const Skull = (props) => <IconBase {...props}><circle cx="9" cy="12" r="1"/><circle cx="15" cy="12" r="1"/><path d="M8 20v2h8v-2"/><path d="m12.5 17-.5-1-.5 1h1z"/><path d="M16 20a2 2 0 0 0 1.56-3.25 8 8 0 1 0-11.12 0A2 2 0 0 0 8 20"/></IconBase>;
        const Trophy = (props) => <IconBase {...props}><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></IconBase>;
        const Music = (props) => <IconBase {...props}><path d="M9 18V5l12-2v13"/><circle cx="6" cy="18" r="3"/><circle cx="18" cy="16" r="3"/></IconBase>;
        const RotateCcw = (props) => <IconBase {...props}><path d="M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8"/><path d="M3 3v5h5"/></IconBase>;
        const Flame = (props) => <IconBase {...props}><path d="M8.5 14.5A2.5 2.5 0 0 0 11 12c0-1.38-.5-2-1-3-1.072-2.143-.224-4.054 2-6 .5 2.5 2 4.9 4 6.5 2 1.6 3 3.5 3 5.5a7 7 0 1 1-14 0c0-1.1.2-2.2.5-3.3.3-1.1.9-2.1 1.7-2.9.2.6.4 1.2.5 1.7.1 1.1-.1 2.2-.2 3.3z"/></IconBase>;

        // --- –ö–æ–Ω—Å—Ç–∞–Ω—Ç—ã –∏ –î–∞–Ω–Ω—ã–µ ---

        const FRIENDS = ["–í–ª–∞–¥–∞", "–°—Ç–∞—Å–∞", "–¢—ë–º—ã"]; // –î—Ä—É–∑—å—è –ù–∏–∫–∏—Ç—ã

        const CLASSES = {
            MAGE: {
                id: 'mage',
                name: '–ü–∏—Ä–æ–º–∞–Ω—Ç',
                description: '–õ—é–±–∏—Ç –ø–æ–≥–æ—Ä—è—á–µ–µ. –ó–∞–∂–∏–≥–∞–µ—Ç –Ω–∞ –ª—é–±–æ–π —Ç—É—Å–æ–≤–∫–µ.',
                emoji: 'üî•',
                hp: 100,
                maxHp: 100,
                charges: 1, 
                chargeName: '–ú–∞–Ω–∞',
                abilities: {
                    special: { name: '–ú–µ—Ç–µ–æ—Ä–∏—Ç', dmg: 70, desc: '–ü–∞–¥–∞–µ—Ç –ø—Ä—è–º–æ —Å –Ω–µ–±–µ—Å (1 –∑–∞—Ä—è–¥!)' },
                    melee1: { name: '–û–∂–æ–≥', dmg: 15, desc: '–ù–µ–ø—Ä–∏—è—Ç–Ω–æ, –Ω–æ —Ç–µ—Ä–ø–∏–º–æ' },
                    melee2: { name: '–í—Å–ø—ã—à–∫–∞ —Å–ª–µ–≤–∞', dmg: 20, desc: '–î–µ–∑–æ—Ä–∏–µ–Ω—Ç–∏—Ä—É–µ—Ç –≤—Ä–∞–≥–∞' }
                }
            },
            WARRIOR: {
                id: 'warrior',
                name: '–í–∏–∫–∏–Ω–≥',
                description: '–ë–æ—Ä–æ–¥–∞ (–≤ –¥—É—à–µ), —Ç–æ–ø–æ—Ä –∏ –±–µ–∑—É–¥–µ—Ä–∂–Ω–∞—è –º–æ—â—å.',
                emoji: 'ü™ì',
                hp: 110, // –ß—É—Ç—å –∂–∏—Ä–Ω–µ–µ
                maxHp: 110,
                charges: 2, 
                chargeName: '–Ø—Ä–æ—Å—Ç—å',
                abilities: {
                    special: { name: '–£–¥–∞—Ä –¢–æ—Ä–∞', dmg: 40, desc: '–ì—Ä–æ–º –∏ –º–æ–ª–Ω–∏–∏!' },
                    melee1: { name: '–ë–æ–¥–ª–∏–≤–∞—è –∫–æ–∑–∞', dmg: 25, desc: '–£–¥–∞—Ä –≥–æ–ª–æ–≤–æ–π' },
                    melee2: { name: '–ú–µ–¥–≤–µ–∂—å–∏ –æ–±—ä—è—Ç–∏—è', dmg: 30, desc: '–î–æ —Ö—Ä—É—Å—Ç–∞ –∫–æ—Å—Ç–µ–π' }
                }
            },
            HUNTER: {
                id: 'hunter',
                name: '–°—Ç–∞–ª–∫–µ—Ä',
                description: '–ó–Ω–∞–µ—Ç –∫–æ—Ä–æ—Ç–∫—É—é –¥–æ—Ä–æ–≥—É –∏ –≥–¥–µ –¥–æ—Å—Ç–∞—Ç—å –∞—Ä—Ç–µ—Ñ–∞–∫—Ç—ã.',
                emoji: '‚ò¢Ô∏è',
                hp: 90, 
                maxHp: 90,
                charges: 2, 
                chargeName: '–ë–æ–ª—Ç—ã',
                abilities: {
                    special: { name: '–ì–∞—É—Å—Å-–ø—É—à–∫–∞', dmg: 50, desc: '–†–µ–ª—å—Å–æ—Ç—Ä–æ–Ω –≤ –¥–µ–π—Å—Ç–≤–∏–∏' },
                    melee1: { name: '–£–¥–∞—Ä –ª–æ–º–æ–º', dmg: 20, desc: '–ü—Ä–æ—Ç–∏–≤ –ª–æ–º–∞ –Ω–µ—Ç –ø—Ä–∏–µ–º–∞' },
                    melee2: { name: '–ë—Ä–æ—Å–æ–∫ –≥–∞–π–∫–∏', dmg: 15, desc: '–ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–Ω–æ–º–∞–ª–∏–π' }
                }
            }
        };

        const QUESTIONS = [
            {
                text: "–ù–∏–∫–∏—Ç–∞, –≥–¥–µ —Ç—ã –±—ã–ª –∑–∞–º–µ—á–µ–Ω –≤ 5 —É—Ç—Ä–∞ –≤ –ø—Ä–æ—à–ª—É—é —Å—É–±–±–æ—Ç—É?",
                options: ["–ù–∞ –ø—Ä–æ–±–µ–∂–∫–µ (–ó–û–ñ —Å–∏–ª–∞)", "–í –º–∞–∫–µ, –µ–ª –¥–≤–æ–π–Ω–æ–π —á–∏–∑–±—É—Ä–≥–µ—Ä", "–í –∫–∞—Ä–∞–æ–∫–µ, –ø–µ–ª '–†—é–º–∫—É –≤–æ–¥–∫–∏'"],
                correct: 1,
                story: "–ö–ª–∞—Å—Å–∏–∫–∞! –°–∏–ª—ã –Ω—É–∂–Ω–æ –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—Ç—å."
            },
            {
                text: "–°—É–ø–µ—Ä—Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å –ù–∏–∫–∏—Ç—ã, –æ –∫–æ—Ç–æ—Ä–æ–π –≤—Å–µ –∑–Ω–∞—é—Ç:",
                options: ["–ü–æ—è–≤–ª—è—Ç—å—Å—è —Ä–æ–≤–Ω–æ –∫ –Ω–∞—á–∞–ª—É —Ç–æ—Å—Ç–∞", "–ß–∏—Ç–∞—Ç—å –º—ã—Å–ª–∏ (–æ—Å–æ–±–µ–Ω–Ω–æ –ø—Ä–æ –µ–¥—É)", "–†–µ—à–∞—Ç—å –ø—Ä–æ–±–ª–µ–º—ã –æ–¥–Ω–∏–º –∑–≤–æ–Ω–∫–æ–º"],
                correct: 2,
                story: "–ò–º–µ–Ω–Ω–æ. –ê–ª–ª–æ, —à–µ—Ñ? –í—Å—ë –ø–æ—Ä–µ—à–∞–ª–∏."
            },
            {
                text: "–ï—Å–ª–∏ –ù–∏–∫–∏—Ç–∞ —Å—Ç–∞–Ω–µ—Ç –º—ç—Ä–æ–º –≥–æ—Ä–æ–¥–∞, –ø–µ—Ä–≤—ã–º –¥–µ–ª–æ–º –æ–Ω:",
                options: ["–ó–∞–ø—Ä–µ—Ç–∏—Ç –ø—Ä–æ–±–∫–∏", "–°–¥–µ–ª–∞–µ—Ç –ø—è—Ç–Ω–∏—Ü—É –≤—ã—Ö–æ–¥–Ω—ã–º", "–ü–æ—Å—Ç–∞–≤–∏—Ç –≤—Å–µ–º –ø–∞–º—è—Ç–Ω–∏–∫ (—Å–µ–±–µ)"],
                correct: 1,
                story: "–ù–∞—Ä–æ–¥ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç! –†–µ–π—Ç–∏–Ω–≥ 146%!"
            }
        ];

        // --- –û—Å–Ω–æ–≤–Ω–æ–π –ö–æ–º–ø–æ–Ω–µ–Ω—Ç ---

        function App() {
            const [stage, setStage] = useState('welcome'); 
            const [heroClass, setHeroClass] = useState(null);
            const [heroStats, setHeroStats] = useState({ hp: 100, charges: 0 });
            const [bossStats, setBossStats] = useState({ hp: 160, maxHp: 160 });
            const [questIndex, setQuestIndex] = useState(0);
            const [battleLog, setBattleLog] = useState(["–°–ò–°–¢–ï–ú–ê: –û–±–Ω–∞—Ä—É–∂–µ–Ω –ë–æ—Å—Å!"]);
            const [isPlayerTurn, setIsPlayerTurn] = useState(true);
            const [shake, setShake] = useState(false);

            const messagesEndRef = useRef(null);

            const scrollToBottom = () => {
                messagesEndRef.current?.scrollIntoView({ behavior: "smooth" });
            };

            useEffect(() => {
                scrollToBottom();
            }, [battleLog]);

            const resetGame = () => {
                setStage('welcome');
                setHeroClass(null);
                setQuestIndex(0);
                setBattleLog(["–°–ò–°–¢–ï–ú–ê: –û–±–Ω–∞—Ä—É–∂–µ–Ω –ë–æ—Å—Å!"]);
                setIsPlayerTurn(true);
                setBossStats({ hp: 160, maxHp: 160 });
            };

            const selectClass = (key) => {
                const selected = CLASSES[key];
                setHeroClass(selected);
                setHeroStats({ hp: selected.hp, charges: selected.charges });
                setStage('quest');
            };

            const handleAnswer = () => {
                if (questIndex < QUESTIONS.length - 1) {
                    setQuestIndex(questIndex + 1);
                } else {
                    setStage('battle');
                }
            };

            const playerAttack = (type) => {
                if (!isPlayerTurn) return;

                let damage = 0;
                let logMsg = "";
                let useCharge = false;

                const abilities = heroClass.abilities;

                if (type === 'special') {
                    if (heroStats.charges > 0) {
                        damage = abilities.special.dmg + Math.floor(Math.random() * 10);
                        logMsg = `–¢—ã –∏—Å–ø–æ–ª—å–∑—É–µ—à—å ${abilities.special.name}! –ö–†–ò–¢: ${damage}!`;
                        useCharge = true;
                    } else {
                        logMsg = "–ù–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å! –≠–Ω–µ—Ä–≥–∏—è –Ω–∞ –Ω—É–ª–µ.";
                    }
                } else if (type === 'melee1') {
                    damage = abilities.melee1.dmg + Math.floor(Math.random() * 5);
                    logMsg = `–ê—Ç–∞–∫–∞: ${abilities.melee1.name}. –£—Ä–æ–Ω: ${damage}.`;
                } else if (type === 'melee2') {
                    damage = abilities.melee2.dmg + Math.floor(Math.random() * 5);
                    logMsg = `–ê—Ç–∞–∫–∞: ${abilities.melee2.name}. –£—Ä–æ–Ω: ${damage}.`;
                }

                if (useCharge) {
                    setHeroStats(prev => ({ ...prev, charges: prev.charges - 1 }));
                    if (heroStats.charges - 1 === 0) {
                         logMsg += " (–ó–ê–†–Ø–î–´ –ò–°–ß–ï–†–ü–ê–ù–´!)";
                    }
                }

                const newBossHp = Math.max(0, bossStats.hp - damage);
                setBossStats(prev => ({ ...prev, hp: newBossHp }));
                setBattleLog(prev => [...prev, logMsg]);

                if (newBossHp === 0) {
                    setTimeout(() => setStage('victory'), 1500);
                } else {
                    setIsPlayerTurn(false);
                    setTimeout(bossTurn, 1500);
                }
            };

            const bossTurn = () => {
                const bossDamage = 15 + Math.floor(Math.random() * 20); 
                const phrases = [
                    "–†–æ–±–æ-–ë–æ—Å—Å: '–ì–¥–µ —Ç–≤–æ–π –≥–æ–¥–æ–≤–æ–π –æ—Ç—á–µ—Ç?'",
                    "–°–±–æ–π –º–∞—Ç—Ä–∏—Ü—ã: —Å–ø–∏–Ω–∞ –±–æ–ª–∏—Ç!",
                    "–ë–æ—Å—Å —Å–∫–∞–Ω–∏—Ä—É–µ—Ç –∫–æ—à–µ–ª–µ–∫... –ü—É—Å—Ç–æ!",
                    "–ê—Ç–∞–∫–∞: '–ê —á–∞—Å–∏–∫–∏-—Ç–æ —Ç–∏–∫–∞—é—Ç, –ù–∏–∫–∏—Ç–∞!'",
                    "–£–¥–∞—Ä —Ü–µ–Ω–∞–º–∏ –Ω–∞ –±–µ–Ω–∑–∏–Ω!",
                    "–ë–æ—Å—Å –∫–∏–¥–∞–µ—Ç –≤ —Ç–µ–±—è –æ—Ç–≤–µ—Ç—Å—Ç–≤–µ–Ω–Ω–æ—Å—Ç—å!",
                    "–°–∏–Ω–∏–π —ç–∫—Ä–∞–Ω —Å–º–µ—Ä—Ç–∏... –æ—Ç —Å–∫—É–∫–∏!",
                ];
                const randomPhrase = phrases[Math.floor(Math.random() * phrases.length)];
                
                let actualDamage = bossDamage;
                if (heroStats.hp - bossDamage <= 0) {
                    actualDamage = Math.max(0, heroStats.hp - 1);
                }

                setHeroStats(prev => ({ ...prev, hp: prev.hp - actualDamage }));

                let logMessage = `${randomPhrase} (-${actualDamage} HP)`;
                if (actualDamage === 0) {
                    logMessage = `${randomPhrase} (–ë–†–û–ù–Ø –ù–ï –ü–†–û–ë–ò–¢–ê!)`;
                }

                setBattleLog(prev => [...prev, logMessage]);
                setShake(true);
                setTimeout(() => setShake(false), 500);
                setIsPlayerTurn(true);
            };

            // --- –†–µ–Ω–¥–µ—Ä –°—Ü–µ–Ω ---

            const renderWelcome = () => (
                <div className="flex flex-col items-center justify-center min-h-screen p-6 text-center space-y-8 animate-fade-in bg-gradient-to-b from-stone-900 to-stone-800">
                    <div className="relative">
                        <div className="absolute -top-10 -left-10 text-6xl animate-bounce">üéá</div>
                        <div className="absolute -top-10 -right-10 text-6xl animate-bounce delay-100">üçæ</div>
                        <h1 className="text-5xl md:text-7xl font-black text-transparent bg-clip-text bg-gradient-to-r from-amber-400 to-orange-600 drop-shadow-lg tracking-tight">
                            –ù–ò–ö–ò–¢–ê <br/> LEVEL 30
                        </h1>
                    </div>
                    <p className="text-xl text-amber-100 max-w-md font-light">
                        –°–∏—Å—Ç–µ–º–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∞. –£—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω –ø–∞–∫–µ—Ç "–ú—É–¥—Ä–æ—Å—Ç—å v3.0". <br/>
                        <span className="text-sm opacity-60">(–í–æ–∑–º–æ–∂–Ω—ã –±–∞–≥–∏ —Å –ø–æ—Ö–º–µ–ª—å–µ–º)</span>
                    </p>
                    <button 
                        onClick={() => setStage('select')}
                        className="px-8 py-4 bg-gradient-to-r from-orange-600 to-red-600 rounded-full text-xl font-bold hover:scale-105 transition-transform shadow-xl shadow-orange-500/20 flex items-center gap-2 text-white border border-orange-400/30"
                    >
                        <Flame size={24} /> –ù–∞—á–∞—Ç—å –ó–∞–º–µ—Å
                    </button>
                </div>
            );

            const renderSelect = () => (
                <div className="flex flex-col items-center justify-center min-h-screen p-4 bg-stone-900">
                    <h2 className="text-3xl font-bold mb-8 text-white">–í—ã–±–µ—Ä–∏ –ê–≤–∞—Ç–∞—Ä</h2>
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-6 w-full max-w-4xl">
                        {Object.keys(CLASSES).map((key) => {
                            const cls = CLASSES[key];
                            return (
                                <div 
                                    key={key}
                                    onClick={() => selectClass(key)}
                                    className="bg-stone-800/80 backdrop-blur-md border border-stone-600 p-6 rounded-2xl cursor-pointer hover:border-orange-500 hover:bg-stone-700/80 transition-all transform hover:-translate-y-2 group"
                                >
                                    <div className="text-6xl mb-4 group-hover:scale-110 transition-transform">{cls.emoji}</div>
                                    <h3 className="text-2xl font-bold text-white mb-2">{cls.name}</h3>
                                    <p className="text-stone-300 mb-4 h-12">{cls.description}</p>
                                    <div className="flex justify-between text-sm text-stone-300 bg-stone-900 p-3 rounded-lg">
                                        <span className="flex items-center gap-1"><Heart className="w-4 h-4 text-red-500"/> {cls.hp} HP</span>
                                        <span className="flex items-center gap-1"><Zap className="w-4 h-4 text-yellow-400"/> –°–∏–ª–∞</span>
                                    </div>
                                </div>
                            )
                        })}
                    </div>
                </div>
            );

            const renderQuest = () => (
                <div className="flex flex-col items-center justify-center min-h-screen p-6 max-w-2xl mx-auto bg-stone-900">
                    <div className="bg-stone-800/90 p-8 rounded-3xl border border-stone-600 shadow-2xl w-full shadow-orange-900/20">
                        <div className="flex items-center gap-3 mb-6">
                            <div className="w-12 h-12 rounded-full bg-orange-600 flex items-center justify-center text-2xl shadow-lg shadow-orange-500/30">
                                {heroClass.emoji}
                            </div>
                            <div>
                                <h3 className="text-xl font-bold text-white">–§–∞–π–ª –æ—Ç: {FRIENDS[questIndex % FRIENDS.length]}</h3>
                                <span className="text-xs text-orange-400 font-mono">–≠—Ç–∞–ø {questIndex + 1}</span>
                            </div>
                        </div>
                        
                        <p className="text-xl text-white mb-8 leading-relaxed">
                            {QUESTIONS[questIndex].text}
                        </p>

                        <div className="space-y-3">
                            {QUESTIONS[questIndex].options.map((opt, i) => (
                                <button
                                    key={i}
                                    onClick={handleAnswer}
                                    className="w-full text-left p-4 rounded-xl bg-stone-700 hover:bg-orange-600 text-white transition-colors border border-stone-600 hover:border-orange-400 group"
                                >
                                    <span className="inline-block w-2 h-2 rounded-full bg-stone-500 group-hover:bg-white mr-3 mb-0.5"></span>
                                    {opt}
                                </button>
                            ))}
                        </div>
                    </div>
                </div>
            );

            const renderBattle = () => {
                const canUseSpecial = heroStats.charges > 0;
                const isLowHp = heroStats.hp < (heroClass.maxHp * 0.3);

                return (
                    <div className={`flex flex-col items-center min-h-screen p-4 pt-10 max-w-lg mx-auto ${shake ? 'animate-shake' : ''} bg-stone-900`}>
                        {/* Boss Area - –°–µ—Ä—ã–π/–ú–µ—Ç–∞–ª–ª–∏–∫ —Å—Ç–∏–ª—å */}
                        <div className="w-full bg-slate-800 rounded-2xl p-6 mb-4 border border-slate-500 relative overflow-hidden shadow-lg shadow-black/50">
                            <div className="absolute top-0 right-0 p-2 opacity-10 text-white">
                                <Skull size={100} />
                            </div>
                            <div className="flex justify-between items-center mb-2">
                                <h3 className="text-2xl font-black text-slate-200 tracking-wider">–†–û–ë–û-–ö–†–ò–ó–ò–°</h3>
                                <span className="text-slate-400 font-mono">{bossStats.hp}/{bossStats.maxHp} HP</span>
                            </div>
                            <div className="w-full bg-black h-4 rounded-full overflow-hidden border border-slate-600">
                                <div 
                                    className="bg-red-600 h-full transition-all duration-500" 
                                    style={{ width: `${(bossStats.hp / bossStats.maxHp) * 100}%` }}
                                ></div>
                            </div>
                            <div className="mt-4 flex justify-center">
                                {/* –†–æ–±–æ—Ç */}
                                <div className="text-8xl animate-pulse filter drop-shadow-[0_0_15px_rgba(255,255,255,0.3)]">ü§ñ</div>
                            </div>
                        </div>

                        {/* Battle Log */}
                        <div className="w-full h-32 bg-black/80 rounded-xl p-4 mb-4 overflow-y-auto text-sm space-y-1 font-mono border border-orange-900/50 shadow-inner">
                            {battleLog.map((log, i) => (
                                <div key={i} className={i === battleLog.length - 1 ? "text-orange-400 font-bold" : "text-stone-400"}>
                                    {">"} {log}
                                </div>
                            ))}
                            <div ref={messagesEndRef} />
                        </div>

                        {/* Player Area - –û—Ä–∞–Ω–∂–µ–≤—ã–π/–Ø–Ω—Ç–∞—Ä–Ω—ã–π —Å—Ç–∏–ª—å */}
                        <div className={`w-full bg-orange-900/20 rounded-2xl p-6 border transition-colors ${isLowHp ? 'border-red-500 animate-pulse bg-red-900/10' : 'border-orange-500/30'}`}>
                            <div className="flex justify-between items-center mb-4">
                                <div className="flex items-center gap-2">
                                    <span className="text-4xl">{heroClass.emoji}</span>
                                    <div>
                                        <h3 className="font-bold text-white">{heroClass.name}</h3>
                                        <div className="text-xs text-orange-300 flex items-center gap-1">
                                            {heroClass.charges > 0 ? (
                                                <span className="text-amber-400">{heroClass.chargeName}: {heroStats.charges}</span>
                                            ) : (
                                                <span className="text-stone-500 font-bold uppercase">–ù–ï–¢ –ó–ê–†–Ø–î–û–í</span>
                                            )}
                                        </div>
                                    </div>
                                </div>
                                <div className="text-right">
                                    <span className={`font-mono text-xl ${isLowHp ? 'text-red-500 font-black' : 'text-white'}`}>
                                        {heroStats.hp}/{heroClass.maxHp} HP
                                    </span>
                                </div>
                            </div>

                            <div className="grid grid-cols-1 gap-3">
                                {canUseSpecial ? (
                                    <button 
                                        onClick={() => playerAttack('special')}
                                        disabled={!isPlayerTurn}
                                        className="w-full py-4 bg-gradient-to-r from-orange-500 to-red-600 rounded-xl font-bold text-white shadow-lg transform active:scale-95 transition-all flex items-center justify-center gap-2 hover:from-orange-400 hover:to-red-500 border border-orange-400/20"
                                    >
                                        <Zap /> {heroClass.abilities.special.name} <span className="text-xs bg-black/20 px-2 py-1 rounded text-orange-100">DMG: {heroClass.abilities.special.dmg}</span>
                                    </button>
                                ) : (
                                    <div className="grid grid-cols-2 gap-3">
                                        <button 
                                            onClick={() => playerAttack('melee1')}
                                            disabled={!isPlayerTurn}
                                            className="py-4 bg-stone-700 hover:bg-stone-600 rounded-xl font-bold text-white active:scale-95 transition-all border-b-4 border-stone-800"
                                        >
                                            {heroClass.abilities.melee1.name}
                                        </button>
                                        <button 
                                            onClick={() => playerAttack('melee2')}
                                            disabled={!isPlayerTurn}
                                            className="py-4 bg-stone-700 hover:bg-stone-600 rounded-xl font-bold text-white active:scale-95 transition-all border-b-4 border-stone-800"
                                        >
                                            {heroClass.abilities.melee2.name}
                                        </button>
                                    </div>
                                )}
                                
                                <div className="text-center text-xs text-stone-500 mt-2">
                                    {!canUseSpecial && "–ò—Å–ø–æ–ª—å–∑—É–π –æ–±—ã—á–Ω—ã–µ –∞—Ç–∞–∫–∏!"}
                                </div>
                            </div>
                        </div>
                    </div>
                );
            };

            const renderVictory = () => (
                <div className="flex flex-col items-center justify-center min-h-screen p-6 text-center animate-fade-in bg-stone-900 bg-[url('https://www.transparenttextures.com/patterns/stardust.png')]">
                    <div className="mb-8 relative">
                        <div className="absolute inset-0 animate-ping opacity-75 rounded-full bg-orange-500"></div>
                        <Trophy size={80} className="text-yellow-500 relative z-10" />
                    </div>
                    
                    <h1 className="text-4xl md:text-6xl font-black text-white mb-4">–¢–´ –õ–ï–ì–ï–ù–î–ê!</h1>
                    <p className="text-xl text-stone-300 mb-8 max-w-lg">
                        –ù–∏–∫–∏—Ç–∞, –±–æ—Å—Å –ø–æ–≤–µ—Ä–∂–µ–Ω! –°–∏—Å—Ç–µ–º–∞ –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞. –ê–∫—Ç–∏–≤–∏—Ä–æ–≤–∞–Ω —Ä–µ–∂–∏–º "–õ—É—á—à–∏–µ –≥–æ–¥—ã".
                    </p>
                    
                    <div className="bg-stone-800 p-6 rounded-2xl border border-orange-500/50 shadow-2xl shadow-orange-500/20 max-w-md w-full mb-8">
                        <h3 className="text-xl font-bold text-orange-300 mb-4">–õ—É—Ç –õ–µ–≥–µ–Ω–¥–∞—Ä–Ω–æ–≥–æ –†–∞–Ω–≥–∞:</h3>
                        <a 
                            href="https://music.yandex.ru/album/2822763/track/24225052" 
                            target="_blank" 
                            rel="noopener noreferrer"
                            className="flex items-center justify-center gap-3 w-full py-6 bg-gradient-to-r from-orange-500 to-red-600 hover:from-orange-400 hover:to-red-500 text-white rounded-xl font-bold text-2xl shadow-lg transform hover:-translate-y-1 transition-all animate-pulse"
                        >
                            <Music size={28} />
                            –í–†–£–ë–ê–ô –ú–£–ó–õ–û
                        </a>
                        <p className="text-stone-400 text-sm mt-4">
                            (–ù–∞–∂–º–∏ –∫–Ω–æ–ø–∫—É –∏ –≥–æ—Ç–æ–≤—å—Å—è –∫ –≤–µ—á–µ—Ä–∏–Ω–∫–µ!)
                        </p>
                    </div>

                    <button
                        onClick={resetGame}
                        className="flex items-center gap-2 text-stone-400 hover:text-white transition-colors"
                    >
                        <RotateCcw size={18} />
                        –ü–µ—Ä–µ–∏–≥—Ä–∞—Ç—å
                    </button>

                    <div className="mt-8 flex gap-4 text-4xl animate-bounce">
                        <span>ü•É</span><span>ü¶Å</span><span>üëë</span>
                    </div>
                </div>
            );

            return (
                <div className="min-h-screen bg-stone-900 text-white font-sans selection:bg-orange-500 selection:text-white overflow-x-hidden">
                    {stage === 'welcome' && renderWelcome()}
                    {stage === 'select' && renderSelect()}
                    {stage === 'quest' && renderQuest()}
                    {stage === 'battle' && renderBattle()}
                    {stage === 'victory' && renderVictory()}
                </div>
            );
        }

        const root = ReactDOM.createRoot(document.getElementById('root'));
        root.render(<App />);
    </script>
</body>
</html>